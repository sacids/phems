{% extends 'layout/base.html' %}
{% load static %}
{% load humanize %}
{% load filters %}

{% block contents %}

<p class="pl-10 mt-5 text-2xl"> Events </p>
<div class="pl-10 flex w-full my-2" x-init="fetchSignals();fetchEvents();">

    <!-- search signal input field-->
    <div class="flex rounded p-1 bg-gray-100 border border-gray-300 hover:bg-gray-200">
        <input  
            x-ref="searchEvents"
            x-model="search"
            x-on:keydown.window.prevent.slash="$refs.searchEvents.focus()"
            placeholder="Search events"
            type="text"
            class="bg-transparent border-0 text-sm py-1 px-2 outline-none mr-2 border-transparent focus:border-transparent focus:ring-0" 
            />
        <div class="pt-1 px-2">
            <div x-show="search.length == 0">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
            </div>
            <div x-show="search.length > 0">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 hover:bg-gray-300" viewBox="0 0 20 20" fill="currentColor" @click="search=''">
                    <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                </svg>
            </div>
        </div>
    </div>

    <!-- filter buttons -->
    <div class="p-1">
        <button class="ml-3  rounded bg-gray-100 hover:bg-gray-300 p-1 px-3 text-sm"> Received Today</button>
    </div>
    <div class="p-1">
        <button class="rounded bg-gray-100 hover:bg-gray-300 p-1 px-3 text-sm"> Received this week</button>
    </div>
    <div class="p-1">
        <button 
            class="rounded bg-gray-100 hover:bg-gray-300 p-1 px-3 text-sm" 
            :class="{ 'bg-gray-300': relevanceOver4 }" 
            @click="$refs.searchSignal.focus(), relevanceOver4 = !relevanceOver4"> Relevance over 4</button>
    </div>
</div>

<div class="flex h-full overflow-hidden">
    <div class="flex-1 h-full overflow-y-auto pl-10">
        <div class="flex justify-between">
            <p class="my-3 font-semibold text-sm"> Events </p>
            <p class="my-3 p-1 px-3 rounded-sm text-sm text-white bg-emerald-700 hover:bg-emerald-900">Create Event + </p>
        </div>
        <ul class="divide-y border text-sm">
            <template x-for="(event, index) in filteredEvents" :key="index">
                <li 
                    class="p-1 flex hover:bg-gray-100 pr-10 space-x-3"  
                    :class="{'bg-emerald-100':activeEvent === index}">

                    <span class="text-emerald-500">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                        </svg>
                    </span>
                    <p 
                        class="line-clamp-1 px-2 flex-1 hover:cursor-e-resize" 
                        @click="sidebarOpen = true, activeEvent = index, setEvent(event)"
                        x-text="event.description"></p>
                    <span class=""></span>
                    <span class="rounded-lg bg-orange-300 px-3" x-text="event.status"></span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-slate-200 hover:text-slate-500 hover:cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                    </svg>
                </li>
            </template>
        </ul>
        <p class="p-5"> Create Event + </p>
    </div>
    <div class="flex-shrink-0 w-[570px] h-full flex flex-col overflow-y-hidden px-5 ml-5 transition-all duration-500" :class="{ '-mr-[570px]': !sidebarOpen }">
        <div class="py-2 flex justify-between">
            <div></div>
            <div class="flex space-x-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5" />
                </svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z" />
                </svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM16 12a2 2 0 100-4 2 2 0 000 4z" />
                </svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hover:bg-gray-100" viewBox="0 0 20 20" fill="currentColor" @click="sidebarOpen = false">
                    <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                </svg>
            </div>
        </div>
        <div class="h-full overflow-y-auto border-t border-transparent active:border-t">
            
            <p class="text-2xl font-semibold" x-text="cur_event.title"></p>
            <div class="flex space-x-3">
                <p class="text-xs text-gray-400" x-text="cur_event.location"></p>
                <p class="text-xs text-gray-400" x-text="cur_event.sectors"></p>
            </div>
            <div class="flex space-x-2 my-5 text-md">
                <button class="bg-gray-100 p-1 rounded-sm hover:bg-red-600 hover:text-white" @click="$refs.attachment.click()">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13" />
                    </svg>
                </button>
                <button class="bg-gray-100 p-1 rounded-sm hover:bg-gray-300">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                    </svg>
                </button>
                <button class="bg-gray-100 p-1 rounded-sm hover:bg-gray-300">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z" />
                        <path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" />
                    </svg>
                </button>

                <div x-on:click="setStageOpen = !setStageOpen" class="mt-3 rounded-sm bg-gray-400 px-5 hover:bg-gray-300 font-semibold">    
                    <span x-text="cur_event.stage"></span>
                    <span :class="{'rotate-90': setStageOpen}">&raquo;</span>
                </div>
                <ul x-show="setStageOpen" class="absolute mt-10 text-sm z-50 bg-white rounded-sm border-gray-300 shadow mt-2" x-transition.opacity>
                    <li class="pl-3 pr-10 py-2 hover:bg-gray-200"><a href="#">On Progress</a></li>
                    <li class="pl-3 pr-10 py-2 hover:bg-gray-200"><a href="#">Verifiied</a></li>   
                    <li class="pl-3 pr-10 py-2 hover:bg-gray-200"><a href="#">Risk Assesement</a></li>  
                    <li class="pl-3 pr-10 py-2 hover:bg-gray-200"><a href="#">Monitoring</a></li>   
                    <li class="pl-3 pr-10 py-2 hover:bg-gray-200"><a href="#">Complete</a></li>   
                </ul>
            </div>

            

            <input type="file" x-ref="attachment" class="hidden" name="attachment" id="photo">

            <p class="text-sm font-semibold mt-5 mb-3 ">Description:</p>
            <p class="text-xs line-clamp-3" x-text="cur_event.description"></p>

            <p class="text-sm font-semibold">Attachments</p>
            <div></div>

            <p class="text-sm font-semibold">Links</p>
            <div></div>
            <div x-show="addLinkWrp">
                <p class="text-sm text-gray-300"> Url </p>
                <div class="grid grid-cols-2 gap-4 text-xs">
                    <input type="text" class="rounded-sm border bg-gray-50 hover:bg-gray-200 border-gray-400 p-2" placeholder="www.example.com">
                    <input type="text" class="rounded-sm border bg-gray-50 hover:bg-gray-200 border-gray-400 p-2" placeholder="Add a description ...">
                </div>
                <div class="flex space-x-2 mt-2 justify-right text-sm">
                    <a class="rounded-sm bg-gray-200 px-2 py-1"> Link </a>
                    <a class="rounded-sm bg-gray-200 px-2 py-1"> Cancel </a>
                </div>

            </div>

            <p class="text-sm font-semibold">Comments</p>
            <div></div>
            
        </div>
    </div>
</div>

  <!--Overlay-->
<div class="overflow-auto" style="background-color: rgba(0,0,0,0.5)" x-show="showModal" :class="{ 'absolute inset-0 z-10 flex items-center justify-center': showModal }">
    <!--Dialog-->
    <div class="bg-white w-9/12 lg:w-6/12  mx-auto rounded shadow-lg py-4 text-left px-6" x-show="showModal" @click.away="showModal = false" x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0 scale-90" x-transition:enter-end="opacity-100 scale-100" x-transition:leave="ease-in duration-300" x-transition:leave-start="opacity-100 scale-100" x-transition:leave-end="opacity-0 scale-90">

        <!--Title-->
        <div class="flex justify-between items-center pb-3">
            <p class="text-2xl font-bold">Attach to Event</p>
            <div class="cursor-pointer z-50" @click="showModal = false">
                <svg class="fill-current text-black" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18">
                    <path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"></path>
                </svg>
            </div>
        </div>

        <!-- content -->
        <template x-if="eModal=='attachEvent'">
            <div>
                <div class="flex rounded p-1 bg-gray-100 border border-gray-300 hover:bg-gray-200 my-4">
                    <input  
                        x-ref="searchEvent"
                        x-model="searchEvent"
                        x-on:keydown.window.prevent.slash="$refs.searchEvent.focus()"
                        placeholder="Search events"
                        type="text"
                        class="bg-transparent w-full border-0 text-sm py-1 px-2 outline-none mr-2 border-transparent focus:border-transparent focus:ring-0" 
                        />
                    <div class="pt-1 px-2">
                        <div x-show="searchEvent.length == 0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                            </svg>
                        </div>
                        <div x-show="searchEvent.length > 0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 hover:bg-gray-300" viewBox="0 0 20 20" fill="currentColor" @click="searchEvent=''">
                                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                            </svg>
                        </div>
                    </div>
                </div>

                <ul class="divide-y border text-base">
                    <template x-for="(event, index) in filteredEvents" :key="index">
                        <li class="p-2 flex justify-between hover:bg-gray-100 space-x-3">
                            <div class="flex flex-col">
                                <p class="hover:cursor-pointer" x-text="event.description"></p>
                                <p class="text-xs font-light" x-text="event.status+' '+event.location+' '+event.status"></p>
                            </div>
                            <button class="bg-emerald-500 hover:bg-emerald-400 text-sm p-2 px-4 rounded-md" @click="attachSignal(event)">Attach</button>
                        </li>
                    </template>
                </ul>

                <!--Footer-->
                <div class="flex justify-end pt-2">
                    <button class="modal-close mr-3 text-white text-sm p-2 px-4 rounded-md bg-red-600 hover:bg-red-500 " @click="showModal = false">Close</button>
                </div>
            </div>
        </template>

        <template x-if="eModal=='setEvent'">
            <div class="flex flex-col text-xs" x-init="initjq()">

                <p class="mt-5 mb-1">Description</p>
                <textarea id="textarea" name="description" class="text-sm rounded-sm border-gray-300 bg-gray-50 hover:bg-gray-100" maxlength="225" rows="3" placeholder="" x-model="new_event.description"></textarea>
        

                <p class="mt-5 mb-1">Location</p>
                <select x-ref="location" class="get_location text-sm rounded-sm border-gray-300 bg-gray-50 hover:bg-gray-100 md:w-1/2" id="location" name="location" x-model="new_event.location"></select>

                <p class="mt-5 mb-1">Sectors</p>
                <select x-ref="sectors" class="select2 select2-multiple text-sm rounded-sm border-gray-300 bg-gray-50 hover:bg-gray-100 multiple"  name="sector" id="sectors" multiple="multiple" data-placeholder="Choose ..."  x-model="new_event.sector">
                    {% for sector in sectors %}
                        <option value="{{sector.id}}">{{sector.title}}</option>
                    {% endfor %}
                </select>

                <p class="mt-5 mb-1">Contact Person</p>
                <input type="text" class="text-sm rounded-sm border-gray-300 bg-gray-50 hover:bg-gray-100"  x-model="new_event.contact_name"/>

                <div class="mt-5 mb-1 flex justify-between">
                    <div>
                        <p class="mb-1">Profession</p>
                        <select class="text-sm rounded-sm border-gray-300 bg-gray-50 hover:bg-gray-100" id="profession" name="contact_prof" aria-label="Profession"  x-model="new_event.contact_prof">
                            <option selected="">Open this select menu</option>
                            {% for v, t in profession %}
                                <option value="{{v}}">{{t}}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div>
                        <p class="mb-1">Phone Number</p>
                        <input class="text-sm rounded-sm border-gray-300 bg-gray-50 hover:bg-gray-100 input-mask" data-inputmask="'mask': '+255-999-999-999'" im-insert="true" type="text"  x-model="new_event.contact_phone" />
                    </div>
                    <div>
                        <p class="mb-1">Email</p>
                        <input class="text-sm rounded-sm border-gray-300 bg-gray-50 hover:bg-gray-100" type="email" class=""  x-model="new_event.contact_email"/>
                    </div>
                </div>

                <p x-text="eventFormEl.message"></p>


                <!--Footer-->
                <div class="flex space-x-3 justify-end pt-2">
                    <button class="modal-close text-white text-sm p-2 px-4 rounded-md bg-red-600 hover:bg-red-500 " @click="showModal = false">Cancel</button>
                    <button 
                        class="modal-close text-white text-sm p-2 px-4 rounded-md bg-emerald-600 hover:bg-emerald-500 " 
                        @click="addEvent()"
                        x-text="eventFormEl.label" :disabled="eventFormEl.loading"></button>
                </div>

            </div>
        </template>
        



    </div>
    <!--/Dialog -->
</div><!-- /Overlay -->


{% endblock %}



{% block get_contents %}

<script src="{% static 'libs/popper/popper.min.js' %}"></script>
<link href="{% static 'libs/select2/css/select2.min.css' %}" rel="stylesheet" type="text/css">
<script src="{% static 'libs/jquery/jquery.min.js' %}"></script>
<script src="{% static 'libs/select2/js/select2.min.js' %}"></script>
<script src="{% static 'libs/inputmask/min/jquery.inputmask.bundle.min.js' %}"></script>

<script>


    function getContents() {
        return {
            search:         "",
            searchEvent:    "",
            sidebarOpen:    false,
            signals:        [],
            events:         [],
            relevanceOver4: false,
            receivedToday:  false,
            receivedWeek:   false,
            activeEvent:    -1,
            showModal:      false,
            eModal:         "setEvent",
            setStageOpen:   false,
            addLinkWrp:     true,


            eventFormEl: {
                label:     "Add Event",
                loading:    false,
                message:    "" 
            },

            cur_signal: {
                id              : "",
                channel         : "", 
                contact         : "",
                contents        : "",
                relevance       : "",
                status          : "",
                created_on      : "",
            },

            new_event: {
                location        : "",
                title           : "",
                contact_name    : "",
                description     : "",
                sector          : "",
                contact_prof    : "",
                contact_phone   : "",
                contact_email   : "",
                signal          : "",
                stage           : "",
                status          : "",
            },

            cur_event: {
                id              : "",
                location        : "",
                title           : "",
                contact_name    : "",
                description     : "",
                sector          : "",
                contact_prof    : "",
                contact_phone   : "",
                contact_email   : "",
                signal          : "",
                stage           : "",
                status          : "",
            },

            new_link: {
                title           : "",
                url             : "",
                event_id        : "",
            },

            

            setSignal(e){
                this.cur_signal = e;
                this.new_event.signal = e.id;
            },


            setEvent(e){
                this.cur_event = e;
            },

            get filteredSignals() {

                // received Today


                // received This week


                // relevance over 4
                if (this.relevanceOver4){
                    console.log('relevance over 4 '+this.relevanceOver4)
                    this.signals = this.signals.filter((item) => {
                        return (item.relevance == 0);
                    })
                }else{
                    this.fetchSignals(); 
                }


                if (this.search === "") {
                    return this.signals;
                }

                return this.signals.filter((item) => {
                    return item.contents
                        .toLowerCase()
                        .includes(this.search.toLowerCase());
                });
            },

            get filteredEvents() {

                if (this.searchEvent === "") {
                    return this.events;
                }

                return this.events.filter((item) => {
                    return item.description
                        .toLowerCase()
                        .includes(this.searchEvent.toLowerCase());
                });
            },


            fetchSignals(){
                this.signals = [
                    {% for signal in signals %}
                        {
                            id              : "{{ signal.id }}",
                            channel         : "{{ signal.channel }}", 
                            contact         : "{{ signal.contact }}",
                            contents        : "{{ signal.contents.text }}",
                            relevance       : "{{ signal.relevance }}",
                            status          : "{{ signal.status }}",
                            created_on      : "{{ signal.created_on }}",
                        },
                    {% endfor %}
                ]
            },

            fetchEvents(){
                this.events = [
                    {% for event in events %}
                        {
                            id              : "{{ event.id }}",
                            title           : "{{ event.title }}",
                            status          : "{{ event.status }}",
                            stage           : "{{ event.stage.title }}",
                            description     : "{{ event.description }}",
                            location        : "{{ event.location.title }}",
                            sectors         : "{% for e in event.sector.all %}{{ e.title }},{% endfor %}",
                            status          : "{{ event.status }}",
                            created_on      : "{{ event.created_on }}",
                        },
                    {% endfor %}
                ]
            },

            attachSignal(e){

                var url     = window.location.origin + '/ems/utils/as?sid='+this.cur_signal.id+'&eid='+e.id;
                console.log(url);

                fetch(url)
                    .then(response => response.json())
                    .then(data => {
                        if(data == 1){
                            this.showModal = false;
                            this.signals.splice(this.signals.indexOf(this.cur_signal), 1);
                            this.signals = this.signals.filter(t => t.id !== this.cur_signal.id);
                        }
                    })
            },

            discardSignal(s){

                var url     = window.location.origin + '/ems/utils/ds?sid='+s.id;
                fetch(url)
                    .then(response => response.json())
                    .then(data => {
                        if(data == 1){
                            this.showModal = false;
                            this.signals.splice(this.signals.indexOf(this.cur_signal), 1);
                            this.signals = this.signals.filter(t => t.id !== this.cur_signal.id);
                        }
                    })
            },

            openAddEvent(){
                this.eModal='setEvent'
                this.showModal = true       
            },

            addEvent(){

                // set values
                const selected  = document.querySelectorAll('#sectors option:checked');
                const values    = Array.from(selected).map(el => el.value);

                this.new_event.location = this.$refs.location.value
                this.new_event.sector   = values


                var data = new FormData();
                data.append('csrfmiddlewaretoken', '{{ csrf_token }}');
                Object.entries(this.new_event).forEach(([key, value]) => {
                    data.append(key,value)
                });

                this.eventFormEl.label      = 'Submitting...'
                this.eventFormEl.loading    = true;
                this.eventFormEl.message    = ''

                var url     = window.location.origin + '/ems/utils/ae'


                fetch(url, {
                    method: 'POST',
                    body: data,
                    credentials : 'same-origin',
                })
                .then(res => res.json())
                .then(data => {
                    this.eventFormEl.message = 'Form sucessfully submitted!';
                    this.eventFormEl.loading = false;
                    this.eventFormEl.label = 'Add Event';

                    Object.keys(this.new_event).forEach(key => {
                        this.new_event[key] = "";
                    });

                    this.$refs.location.value = "";

                    const elements  = document.querySelectorAll('#sectors').options;
                    for(var i = 0; i < elements.length; i++){
                      elements[i].selected = false;
                    }

                    this.showModal =false;
                
                })
                .catch(() => {
                    this.eventFormEl.message = 'Ooops! Something went wrong!';
                    this.eventFormEl.loading = false;
                    this.eventFormEl.label = 'Add Event';
                })
                .finally(() => {
                    //this.eventFormEl.loading = false;
                    //this.eventFormEl.Label = 'Add Event'
                })



            }

            
        }
    }

    function initjq() {

        $(".select2").select2();
        $(".input-mask").inputmask();

        $('.get_location').select2({
            minimumInputLength: 3,
            ajax: {
            url: window.location.origin + '/ems/utils/sl',
            dataType: 'json',
            // Additional AJAX parameters go here; see the end of this chapter for the full code of this example
            }
        });

    };


</script>
{% endblock %}